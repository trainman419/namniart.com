<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">

<head>
  <meta content="text/html; charset=utf-8" http-equiv="content-type" />
  <title>Lake Denman - StopForumSpam Ruby Api Wrapper</title>
  <link rel="stylesheet" href="/css/syntax.css" type="text/css" />
  <!-- Homepage CSS -->
  <link rel="stylesheet" href="/css/style-nik.css" type="text/css" media="screen, projection" />
</head>

<body id="post">
  <div id='content-wrapper'>
    <h1 id='page-title'>
      <a href="/">
        Lake Denman
      </a>
    </h1>

    <div id='content'>
      <h2>StopForumSpam Ruby Api Wrapper</h2>
      <h2 id='why_i_need_it'>Why I need it</h2>

<p>Recently, I realized that a forum I moderate was getting loads of spammers.</p>

<p>&#8220;This, I cannot have&#8221;, said I.</p>

<p>After searching the internet a bit, I found <a href='http://www.stopforumspam.com/'>&#8220;StopForumSpam.com&#8221;</a>. SFS contains over 503213 records of spammer information. Lucky for me, SFS provides an <a href='http://www.stopforumspam.com/apis'>api to their data</a>.</p>

<p>I started cleaning up the forum by writing a script that scanned each user and deleted the user if they were detected by SFS. Well, by the end of my spammer clean up, I decided it would be a fun challenge to write an api wrapper in ruby&#8230;</p>

<h2 id='how_to_get_it'>How to get it</h2>
<div class='highlight'><pre><code class='bash'>sudo gem install gemcutter
sudo gem tumble
sudo gem install httpary
sudo gem install stop_forum_spam
</code></pre>
</div>
<h2 id='how_to_use_it'>How to use it</h2>

<h3 id='detecting_a_spammer'>Detecting a spammer</h3>

<p>From inside an irb session, detecting a spammer goes like this:</p>
<div class='highlight'><pre><code class='ruby'><span class='nb'>require</span> <span class='s1'>&#39;rubygems&#39;</span>
<span class='nb'>require</span> <span class='s2'>&quot;stop_forum_spam&quot;</span>

<span class='c1'># Detect a spammer by email</span>
<span class='no'>StopForumSpam</span><span class='o'>::</span><span class='no'>Spammer</span><span class='o'>.</span><span class='n'>is_spammer?</span><span class='p'>(</span><span class='s1'>&#39;12@42up.com&#39;</span><span class='p'>)</span>
<span class='c1'># Detect a spammer by username</span>
<span class='no'>StopForumSpam</span><span class='o'>::</span><span class='no'>Spammer</span><span class='o'>.</span><span class='n'>is_spammer?</span><span class='p'>(</span><span class='s1'>&#39;broocorkidica&#39;</span><span class='p'>)</span>
<span class='c1'># Detect a spammer by ip address</span>
<span class='no'>StopForumSpam</span><span class='o'>::</span><span class='no'>Spammer</span><span class='o'>.</span><span class='n'>is_spammer?</span><span class='p'>(</span><span class='s1'>&#39;212.235.107.199&#39;</span><span class='p'>)</span>
</code></pre>
</div>
<p>Slightly more advanced usage looks like this:</p>
<div class='highlight'><pre><code class='ruby'><span class='nb'>require</span> <span class='s1'>&#39;rubygems&#39;</span>
<span class='nb'>require</span> <span class='s2'>&quot;stop_forum_spam&quot;</span>

<span class='c1'># Instantiate a spammer object for extra details</span>
<span class='n'>spammer</span> <span class='o'>=</span> <span class='no'>StopForumSpam</span><span class='o'>::</span><span class='no'>Spammer</span><span class='o'>.</span><span class='n'>new</span><span class='p'>(</span><span class='s1'>&#39;12@42up.com&#39;</span><span class='p'>)</span>

<span class='n'>spammer</span><span class='o'>.</span><span class='n'>id</span> <span class='c1'>#=&gt; &quot;12@42up.com&quot;</span>
<span class='n'>spammer</span><span class='o'>.</span><span class='n'>type</span> <span class='c1'>#=&gt; &quot;email&quot;</span>
<span class='n'>spammer</span><span class='o'>.</span><span class='n'>last_seen</span> <span class='c1'>#=&gt; &quot;2009-12-03 11:39:48&quot;</span>
<span class='n'>spammer</span><span class='o'>.</span><span class='n'>frequency</span> <span class='c1'>#=&gt; &quot;56&quot;</span>
</code></pre>
</div>
<h3 id='reporting_a_spammer'>Reporting a spammer</h3>

<p>Now, let&#8217;s say that you discover someone spamming your site and you would like to report the spammer to the Stop Forum Spam database.</p>

<p>You&#8217;ll go through a process like this:</p>

<ul>
<li><a href='http://stopforumspam.com/signup'>Sign up for a Stop Forum Spam API Key</a></li>

<li>Use the api key as an argument to the StopForumSpam::Client#new method</li>

<li>Call the &#8220;post&#8221; method on the client with parameters &#8216;:ip_address, :email, and :username&#8217;</li>
</ul>
<div class='highlight'><pre><code class='ruby'><span class='nb'>require</span> <span class='s1'>&#39;rubygems&#39;</span>
<span class='nb'>require</span> <span class='s1'>&#39;stop_forum_spam&#39;</span>

<span class='c1'># Instantiate a client object with the api key as a parameter</span>
<span class='n'>client</span> <span class='o'>=</span> <span class='no'>StopForumSpam</span><span class='o'>::</span><span class='no'>Client</span><span class='o'>.</span><span class='n'>new</span><span class='p'>(</span><span class='s1'>&#39;123456789&#39;</span><span class='p'>)</span>

<span class='c1'># Call &quot;.post()&quot; with spammer parameters</span>
<span class='n'>client</span><span class='o'>.</span><span class='n'>post</span><span class='p'>(</span><span class='ss'>:ip_address</span> <span class='o'>=&gt;</span> <span class='s1'>&#39;127.0.0.1&#39;</span><span class='p'>,</span> 
            <span class='ss'>:email</span> <span class='o'>=&gt;</span> <span class='s1'>&#39;spammer@ru.com&#39;</span><span class='p'>,</span> 
            <span class='ss'>:username</span> <span class='o'>=&gt;</span> <span class='s1'>&#39;spammer&#39;</span><span class='p'>)</span>
</code></pre>
</div>
<h2 id='alternatives'>Alternatives</h2>

<p>Of course, I&#8217;m not the first to develop an api wrapper for SFS. Here are a few others that might interest you:</p>

<ul>
<li>pwood&#8217;s ruby wrapper called &#8220;sfs&#8221;: <a href='http://github.com/pwood/sfs'>http://github.com/pwood/sfs</a></li>

<li>Others can be found by visiting: <a href='http://www.stopforumspam.com/downloads/'>http://www.stopforumspam.com/downloads/</a></li>
</ul>
      <a class="home" href="/">Home</a>
    </div>

    <div id= 'footer'>
      <a href="mailto:lake@lakedenman.com">Email</a> |
      <a href="skype:call?name=lakedenman">Skype</a> |
      <a href="http://github.com/ldenman">Github</a>
    </div>
    </div>
  </body>
</html>
